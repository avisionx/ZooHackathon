{% extends 'botchat/base.html' %}
{% load static %}
{% block title %}ThiccPandas{% endblock %}
{% block body %}
	
	<nav class="navbar navbar-expand navbar-dark bg-dark">
	  <div class="container">
		<a class="navbar-brand" href="#">ThiccPandas</a>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
		  <span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="navbarResponsive">
		  <ul class="navbar-nav ml-auto">
			<li class="nav-item">
			  <a class="nav-link" href="" onclick="logOut(event)">Logout</a>
			</li>
		  </ul>
		</div>
	  </div>
	</nav>

 	<form role="form" enctype="multipart/form-data">
    	<input type="file" name="files" id="files">
    	<button class="btn btn-secondary" type="submit" onclick="uploadData(event)">Upload</button>
  	</form>

{% endblock %}

{% block javaScripts %}
<script type="text/javascript">
var longitude = -1;
var latitude = -1;

function Loctaion(position){
	longitude = position.coords.longitude;
	latitude = position.coords.latitude;
}

function locationFinder() {
	longitude = -1;
	latitude = -1;
	if(navigator.geolocation){
		navigator.geolocation.getCurrentPosition(Location);
	}
}

function uploadData(event){
	event.preventDefault();
	data = {
		'type': 'uploadData',
		'files': $("#files").val(),
		'longitude': longitude,
		'latitude': latitude,
		csrfmiddlewaretoken: '{{ csrf_token }}'
	}
	$.ajax({  
		url: '',  
		method: 'POST',
		data: data,  
		beforeSend: function(){
			locationFinder();
		},
		success: function(data) {  
			if(data['data'] == 'successUpload'){
				console.log("success");
			}
			else{
				console.log("reset");
			}
		}  
	});
}

function logOut(event){
	$.ajax({  
		url: '',  
		method: 'POST',
		data: {
			'type': "logout",
			csrfmiddlewaretoken: '{{ csrf_token }}'
		},  
		success: function(data) {  
			if(data['data'] == 'logout'){
				document.location.reload();
			}
		}  
	});
}
	
</script>
{% endblock %}  